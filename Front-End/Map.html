<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="Include_Functions/jquery.html"></script>
    <script src="Include_Functions/functions.js"></script>
</head>
<style>
    *{
        margin: 0;
        padding: 0;
    }
    #map{
        width: max-content;
        height: max-content;
    }
    .mapblock{
        height: 400px;
    }
    .tiles{
        height: 100px;
        width: 100px;
        margin-bottom: -4px;
        position: absolute;
    }
    .tiles:hover{
        opacity: 0.5;
    }

    #elements{

    }
    #edit{
        margin: 5px;
    }
    #edit img{
        width: 50px;
        height: 50px;
        margin: 5px;
    }
    #selectTiles{
        width: 100vw;
        margin: 5px;
    }
    #selectTiles p{
        display: inline-block;
        width: 30px;
        height: 50px;
        text-align: center;
        position: relative;
        top: -20px;

    }
    #selectTiles img{
        width: 50px;
        height: 50px;
        margin: -2px 0px;
    }
    #selectTiles img:hover{
        opacity: 0.5;
    }
    #selectTiles2 img:hover{
        opacity: 0.5;
    }
    #selectTiles3 img{
        width: 50px;
        height: 50px;
        margin: -2px 0px;
    }
    #selectTiles3 img:hover{
        opacity: 0.5;
    }
    .hitbox{
        display: inline-block;
        position: relative;
        left: -69px;
        color: red;
        width: 25px;
    }
</style>
<body onload="generateMap()">
<div id="map">

</div>
<div id="edit">
    <img id="saveimg" src="../Images/Street/Tileset_17.png">
</div>
<label for="changeCollisonMode">Collison Mode:</label>
<input id="changeCollisonMode" type="checkbox">
<div id="elements">
    <div id="selectTiles">

    </div>
    <div id="selectTiles2">

    </div>
    <div id="selectTiles3">

    </div>
</div>
<button id="GetArray">Get Map</button>
<div id="ArrayOutput">

</div>

<script>
    //let street = [
    //    5,6,31,32,36,37,38,39,44,45,48,49,50,51,52,53,55,56,58,66,68,79,80,81,82,83,84,87,88,89,89,81,92,93,94,95,96,97,100,101,102,103,104,107,108,111,112,115,116,120,121,124,125,128,129,133,134,137,137,138,141,142,146,147,150,165
    //]
    let street = [
        1,5,6,7,8,36,37,38,39,48,49,50,51,52,53,56,57,66,87,88,89,90,91,100,101,102,103,104,107,108,111,112,115,116,120,121,124,125,128,129,133,134,137,128,141,142,146,147,148,149,150,165
    ]

    let map = [
        "0xp",
        "0xp",
        {
            src: "../Images/Town/Tileset_1.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_2.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_3.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_16.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_17.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_29.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_30.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_31.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_57.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_57.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_53.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_53.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_53.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_53.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_53.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_53.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_53.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_53.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_57.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_57.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_71.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_44.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_73.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_57.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_57.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_66.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_66.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_66.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_66.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_66.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_66.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_66.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_66.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_57.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_57.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_71.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_114.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Town/Tileset_73.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_5.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_6.png",
            collison: false,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        },
        {
            src: "../Images/Street/Tileset_15.png",
            collison: true,
            x: 1,
            y: 1
        }]


//tile = {
//    src: path+"Images/Street/Tileset_17.png",
//    collison: false
//}

//map.push(tile);
    let placeSet = [];
    function generateMap() {
        let counter = 1;
        let counterx = 0;
        let countery = 0;
        let jumps = 1;

        let mapmodel = "<div class='mapblock' style='top:"+map[0]+";left:"+map[1]+"'>"
        for ( let i=2; i<map.length; i++ ) {
            if (map[i].y > 1){
                placeSet[i+20] = map[i].y;
            }

            if (placeSet[i+jumps] != null){
                let number = parseInt(placeSet[i+jumps]);
                counter += number
                countery += number
                jumps += number
            }

            mapmodel += "<img class='tiles' style='width: "+50*map[i].x+"px;height: "+50*map[i].y+"px;top: "+50*counterx+"px;left: "+50*countery+"px' id='"+i+"' src='"+map[i].src+"'>";


            if (counter%20 != 0){
                countery += parseInt(map[i].x)
            } else {
                countery = 0;
                counterx++
            }

            counter += parseInt(map[i].x)
        }
        mapmodel += "</div>";

        document.getElementById("map").innerHTML = mapmodel;

        $(".tiles").css("margin-right","0px");
        refrechbuttons();
    }
    function generateMapWithHitBox() {
        let mapmodel = "<div class='mapblock' style='top:"+map[0]+";left:"+map[1]+"'>"
        for ( let i=2; i<map.length; i++ ) {
            if ((i-1)%20 != 0){
                mapmodel += "<img class='tiles' id='"+i+"' src='"+map[i].src+"'><p class='hitbox'>"+map[i].collison+"</p>";
            } else {
                mapmodel += "<img class='tiles' id='"+i+"' src='"+map[i].src+"'><p class='hitbox'>"+map[i].collison+"</p><br>";
            }
        }
        mapmodel += "</div>";

        document.getElementById("map").innerHTML = mapmodel;

        $(".tiles").css("margin-right","-25px");
        refrechbuttons();
    }

    //for ( let i=0; i<street.length; i++ ) {
    //    $("#selectTiles").append("<img class='showTiles' src='../Images/Street/Tileset_"+ street[i] +".png'>")
    //}
    for ( let k=1; k<=169; k++ ) {
        if (k%13==0){
            $("#selectTiles").append("<img class='showTiles' data-sizex='1' data-sizey='1' src='../Images/Street/Tileset_"+ k +".png'><br>")
        } else {
            $("#selectTiles").append("<img class='showTiles' data-sizex='1' data-sizey='1' src='../Images/Street/Tileset_"+ k +".png'>")
        }
    }


    let SpeczialTyles = [
        true,
        [
            2,
            2
        ],
        [
            1,
            2
        ],
        [
            2,
            1
        ],
        [
            2,
            2
        ],
        [
            2,
            2
        ],
    ]

    for ( let k=1; k<SpeczialTyles.length; k++ ) {

        if (k%14==0){
            $("#selectTiles2").append("<img class='showTiles' style='width: "+50*SpeczialTyles[k][0]+"px;height: "+50*SpeczialTyles[k][1]+"px' data-sizex='"+SpeczialTyles[k][0]+"'  data-sizey='"+SpeczialTyles[k][1]+"'  src='../Images/Street/Special_"+ k +".png'><br>")
        } else {
            $("#selectTiles2").append("<img class='showTiles' style='width: "+50*SpeczialTyles[k][0]+"px;height: "+50*SpeczialTyles[k][1]+"px' data-sizex='"+SpeczialTyles[k][0]+"'  data-sizey='"+SpeczialTyles[k][1]+"' src='../Images/Street/Special_"+ k +".png'>")
        }
    }

    for ( let k=1; k<=169; k++ ) {
        if (k%13==0){
            $("#selectTiles3").append("<img class='showTiles' data-sizex='1' data-sizey='1' src='../Images/Town/Tileset_"+ k +".png'><br>")
        } else {
            $("#selectTiles3").append("<img class='showTiles' data-sizex='1' data-sizey='1' src='../Images/Town/Tileset_"+ k +".png'>")
        }
    }

    function refrechbuttons() {

        $(".tiles").click(function() {
            let id = parseInt($(this).attr('id'));
            if ($('#changeCollisonMode').prop('checked')){

                map[id].collison = !map[id].collison;

                generateMapWithHitBox();
            } else {

                let savex = $('#edit #saveimg').attr('data-sizex');
                let savey = $('#edit #saveimg').attr('data-sizey');

                if ((savex * savey) === 1){
                    map[id].src = $('#edit #saveimg').attr('src');
                } else {
                    map[id].src = $('#edit #saveimg').attr('src');
                    map[id].x = savex
                    map[id].y = savey

                    if (savex>1){
                        map.splice(id+1, savex-1)
                    }

                    if (savey>1) {
                        map.splice(id+19, savey)
                    }

                }

                generateMap();
            }
        });

        $(".showTiles").click(function() {
            let savesrc = $(this).attr('src');
            let savex = $(this).attr('data-sizex');
            let savey = $(this).attr('data-sizey');

            $('#edit #saveimg').attr('src', savesrc);
            $('#edit #saveimg').attr('data-sizex', savex);
            $('#edit #saveimg').attr('data-sizey', savey);
        });

        $("#saveimg").click(function() {
            $(this).attr('src', "../Images/Street/Tileset_17.png");
        });

        $('#changeCollisonMode').change(function() {
            if ($('#changeCollisonMode').prop('checked')){
                generateMapWithHitBox();
            } else {
                generateMap();
            }
        });

        $('#GetArray').click(function (){
            let output = "0px,<br>0px,<br>";
            let tiles = $(".tiles");
            for ( let i=0; i<tiles.length; i++ ) {
                let id = $(tiles[i]).attr('id');

                output += "{<br>";
                output += "    src: &quot;"+  map[id].src +"&quot;,<br>";
                output += "    collison: "+map[id].collison +",<br>";
                output += "    x: 1,<br>";
                output += "    y: 1<br>";
                if (i == tiles.length-1){
                    output += "}";
                } else {
                    output += "},<br>";
                }

            }

            let myJSON = JSON.stringify(map);

            $("#ArrayOutput").html(myJSON);
        });
    }


</script>

</body>
</html>